version: "3.8"

# ============================================
# SIMPLE VERSION - Ohne eigene Datenbank
# FÃ¼r wenn DB extern existiert
# ============================================

services:
  # ============================================
  # FRONTEND - React App mit Nginx
  # ============================================
  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
      args:
        REACT_APP_BACKEND_URL: ${REACT_APP_BACKEND_URL:-http://localhost:8000}
    container_name: oeh-frontend
    restart: unless-stopped
    ports:
      - "${FRONTEND_PORT:-80}:80"
    depends_on:
      - backend
    networks:
      - app-network

  # ============================================
  # BACKEND - FastAPI
  # ============================================
  backend:
    build:
      context: ./backend
      dockerfile: Dockerfile
    container_name: oeh-backend
    restart: unless-stopped
    ports:
      - "${BACKEND_PORT:-8000}:8000"
    environment:
      # Server Config
      BACKEND_HOST: ${BACKEND_HOST:-localhost}
      BACKEND_PORT: ${BACKEND_PORT:-8000}
      PYTHONUNBUFFERED: "1"
      
      # Database Config (externe DB)
      DATABASE_URL: postgresql://${DB_USER:-admin}:${DB_PASSWORD:-changeme123}@${DB_HOST:-localhost}:${DB_PORT:-5432}/${DB_NAME:-oeh_wirtschaft}
      DB_HOST: ${DB_HOST:-localhost}
      DB_PORT: ${DB_PORT:-5432}
      DB_USER: ${DB_USER:-admin}
      DB_PASSWORD: ${DB_PASSWORD:-changeme123}
      DB_NAME: ${DB_NAME:-oeh_wirtschaft}
      
      # Security Config
      SECRET_KEY: ${SECRET_KEY:-oeh-wirtschaft-super-secret-key-2024-jku}
      
      # Master Admin Config
      MASTER_ADMIN_USERNAME: ${MASTER_ADMIN_USERNAME:-masteradmin}
      MASTER_ADMIN_PASSWORD: ${MASTER_ADMIN_PASSWORD:-OeH_Wirtschaft_2024!}
      MASTER_ADMIN_EMAIL: ${MASTER_ADMIN_EMAIL:-master@oeh.jku.at}
    networks:
      - app-network

networks:
  app-network:
    driver: bridge
